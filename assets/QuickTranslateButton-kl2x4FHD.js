import{r as s,j as e,P as q}from"./index-BXMMG8vt.js";import"./_commonjsHelpers-Cpj98o6Y.js";const f={vi:"Tiếng Việt",en:"Tiếng Anh",ja:"Tiếng Nhật",ko:"Tiếng Hàn",zh:"Tiếng Trung"},w=["vi","en","ja","ko","zh"],H=o=>o.toLowerCase().startsWith("zh")?"zh":o.toLowerCase(),_=o=>w.includes(o),I=["https://lt.vern.cc","https://translate.terraprint.co","https://libretranslate.com"],J="fixed inset-0 z-[1000] bg-black/50 backdrop-blur-sm flex items-center justify-center",K="w-[90vw] max-w-[760px] max-h-[85vh] overflow-hidden glass rounded-2xl border border-white/15 shadow-2xl bg-white/10 backdrop-blur-xl text-zinc-100",M="flex items-center justify-between px-4 sm:px-5 py-3 border-b border-white/10",W="text-zinc-300 hover:text-white text-2xl leading-none font-bold px-2",C="p-4 sm:p-5",S="w-full rounded-lg bg-white/5 border border-white/15 text-white placeholder:text-zinc-300/60 outline-none focus:ring-2 focus:ring-blue-400/60 px-3 py-2",z="w-full rounded-lg bg-white/5 border border-white/15 text-white outline-none px-3 py-2",E="text-sm font-medium text-zinc-200 mb-2",F="shrink-0 text-blue-400 hover:text-blue-300 cursor-pointer transition text-xl select-none",G="fixed bottom-5 left-1/2 -translate-x-1/2 z-[1100] px-4 py-2 rounded-lg bg-black/80 text-white text-sm shadow-lg",V="rounded-xl px-3 py-2 text-sm font-medium bg-blue-600 text-white hover:bg-blue-700 focus:ring-2 focus:ring-blue-400 disabled:opacity-50",Q="rounded-xl px-3 py-2 text-sm font-medium bg-zinc-700 text-white hover:bg-zinc-900 focus:ring-2 focus:ring-zinc-400 disabled:opacity-50";function Z({label:o="Dịch nhanh",className:L="",endpoints:R=I,portalSelector:B="body"}){const[x,c]=s.useState(!1),[r,g]=s.useState("auto"),[p,y]=s.useState("en"),[m,j]=s.useState(""),[l,d]=s.useState(""),[b,v]=s.useState(!1),[N,T]=s.useState(null);s.useEffect(()=>{if(!x)return;const t=n=>n.key==="Escape"&&c(!1);return document.addEventListener("keydown",t),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",t),document.body.style.overflow=""}},[x]);function a(t){T(t),window.setTimeout(()=>T(null),2200)}async function O(t,n,i){const k=t.trim();if(!k)throw new Error("Nội dung rỗng");const h=await fetch("/api/lt/translate",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({q:k,source:n,target:i,format:"text"})}),u=await h.text();if(!h.ok)try{const A=JSON.parse(u);throw new Error(A?.error||u||`HTTP ${h.status}`)}catch{throw new Error(u||`HTTP ${h.status}`)}return JSON.parse(u)}async function $(){const t=m.trim();if(!t)return a("Nhập nội dung cần dịch đã đại ca!");v(!0),d("");try{const n=await O(t,r,p);if(d(n.translatedText||""),r==="auto"&&n.detectedLanguage?.language){const i=H(n.detectedLanguage.language);_(i)&&(g(i),a(`Đã phát hiện ngôn ngữ: ${f[i]}`))}}catch(n){d(`Lỗi: ${n?.message||n}`),a("Hệ thống dịch đang tắc, thử lại giúp em!")}finally{v(!1)}}function P(){if(r==="auto")return a('Đang ở "Tự động phát hiện" không thể hoán đổi!');const t=r;g(p),y(t),j(l),d(m)}function D(){if(!l)return a("Không có nội dung để copy!");navigator.clipboard.writeText(l).then(()=>a("Đã copy kết quả!"),()=>a("Copy thất bại (trình duyệt chặn)!"))}return e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:L||"rounded-xl border border-white/15 bg-white/10 backdrop-blur-md px-3 py-2 text-sm font-semibold text-white hover:bg-white/20",onClick:()=>c(!0),children:o}),x&&e.jsx(q,{selector:B,children:e.jsxs("div",{className:J,onMouseDown:t=>t.target===t.currentTarget&&c(!1),children:[e.jsxs("div",{className:`${K} animate-in fade-in zoom-in duration-150`,children:[e.jsxs("div",{className:M,children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Công cụ dịch nhanh"}),e.jsx("button",{className:W,onClick:()=>c(!1),"aria-label":"Đóng",children:"×"})]}),e.jsxs("div",{className:`${C} grid grid-cols-1 md:grid-cols-[1fr_auto_1fr] gap-3 md:gap-4`,children:[e.jsxs("div",{children:[e.jsx("label",{className:E,children:"Ngôn ngữ nguồn"}),e.jsxs("select",{className:z,value:r,onChange:t=>g(t.target.value),children:[e.jsx("option",{value:"auto",children:"Tự động phát hiện"}),w.map(t=>e.jsx("option",{value:t,children:f[t]},t))]}),e.jsx("div",{className:"mt-2",children:e.jsx("textarea",{className:S,rows:7,placeholder:"Gõ hoặc dán nội dung cần dịch...",value:m,onChange:t=>j(t.target.value)})})]}),e.jsx("div",{className:"flex items-center justify-center pt-6 md:pt-8",children:e.jsx("button",{type:"button",className:F,title:"Đảo chiều",onClick:P,children:"⇆"})}),e.jsxs("div",{children:[e.jsx("label",{className:E,children:"Dịch sang"}),e.jsx("select",{className:z,value:p,onChange:t=>y(t.target.value),children:w.map(t=>e.jsx("option",{value:t,children:f[t]},t))}),e.jsx("div",{className:"mt-2",children:e.jsx("textarea",{className:`${S} min-h-[2.5rem]`,rows:7,placeholder:"Kết quả sẽ hiển thị ở đây...",value:l,readOnly:!0})})]})]}),e.jsxs("div",{className:`${C} flex items-center justify-end gap-2 border-t border-white/10`,children:[e.jsx("button",{type:"button",className:Q,onClick:D,children:"Copy kết quả"}),e.jsxs("button",{type:"button",disabled:b,className:`${V} inline-flex items-center gap-2`,onClick:$,children:[b&&e.jsxs("svg",{className:"h-4 w-4 animate-spin",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),e.jsx("span",{children:b?"Đang dịch...":"Dịch"})]})]})]}),N&&e.jsx("div",{className:G,children:N})]})})]})}export{Z as default};
