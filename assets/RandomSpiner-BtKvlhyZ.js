import{r as l,j as t}from"./index-DKdO3KDO.js";import"./_commonjsHelpers-Cpj98o6Y.js";const y=Math.PI*2,U=(a,m,x)=>Math.min(x,Math.max(m,a)),X=a=>1-Math.pow(1-a,3),z=["#00BCD4","#8BC34A","#FFC107","#E91E63","#9C27B0","#03A9F4","#4CAF50","#FF9800","#F44336","#3F51B5"];function K(a){const[m,x]=l.useState({w:0,h:0});return l.useEffect(()=>{if(!a.current)return;const w=new ResizeObserver(()=>{const f=a.current;x({w:f.clientWidth,h:f.clientHeight})});return w.observe(a.current),()=>w.disconnect()},[a]),m}function G(){const[a,m]=l.useState("list"),[x,w]=l.useState(!0),[f,D]=l.useState(`Táo
Cam
Nho
Dâu
Xoài
Chuối
vải`),h=l.useMemo(()=>f.split(`
`).map(n=>n.trim()).filter(Boolean),[f]),[p,F]=l.useState(null),[C,H]=l.useState(0),[R,Q]=l.useState(100),[T,S]=l.useState(null),[A,q]=l.useState([]),E=l.useRef(null),{w:$,h:B}=K(E),I=l.useRef(null),P=l.useRef(0),u=l.useRef(null),W=n=>{const r=I.current;if(!r)return;const e=r.getContext("2d");if(!e)return;const d=window.devicePixelRatio||1,s=Math.min($,B)*.98,o=Math.max(50,s/2-16);r.width=Math.floor(s*d),r.height=Math.floor(s*d),r.style.width=`${s}px`,r.style.height=`${s}px`,e.setTransform(d,0,0,d,0,0),e.clearRect(0,0,s,s);const g=s/2,b=s/2;e.save(),e.translate(g,b),e.rotate(n);const N=Math.max(2,h.length),v=y/N;for(let i=0;i<N;i++){const c=i*v,M=c+v;e.beginPath(),e.moveTo(0,0),e.arc(0,0,o,c,M),e.closePath(),e.fillStyle=z[i%z.length],e.globalAlpha=.88,e.fill(),e.globalAlpha=1,e.strokeStyle="rgba(255,255,255,.25)",e.lineWidth=2,e.beginPath(),e.moveTo(0,0),e.arc(0,0,o,c,M),e.stroke();const k=c+v/2;e.save(),e.rotate(k),e.textAlign="center",e.textBaseline="middle",e.fillStyle="#fff",e.font=`${Math.max(12,Math.floor(o/9))}px ui-sans-serif, system-ui, -apple-system`,e.fillText(h[i]??`Item ${i+1}`,o*.62,0),e.restore()}e.beginPath(),e.arc(g,b,o*.08,0,y),e.fillStyle="rgba(255,255,255,0.08)",e.fill(),e.restore(),e.save(),e.translate(g,b),e.rotate(-Math.PI/2),e.fillStyle="#fff",e.beginPath(),e.moveTo(o+10,0),e.lineTo(o-10,10),e.lineTo(o-10,-10),e.closePath(),e.fill(),e.restore(),e.beginPath(),e.arc(g,b,o,0,y),e.strokeStyle="rgba(255,255,255,.7)",e.lineWidth=3,e.stroke()};l.useEffect(()=>{W(P.current)},[$,B,h.length]);const _=()=>{if(h.length<2)return alert("Cần ít nhất 2 mục để quay.");let n=h.map((i,c)=>c);!x&&p&&(n=n.filter(i=>h[i]!==p),n.length||(n=h.map((i,c)=>c)));const r=n[Math.floor(Math.random()*n.length)],e=h.length,d=-Math.PI/2-(r+.5)/e*y,s=P.current,j=3,o=Math.floor(Math.random()*3),g=d+(Math.ceil((s-d)/y+j)+o)*y,b=4200,N=performance.now(),v=i=>{const c=U((i-N)/b,0,1),M=X(c),k=s+(g-s)*M;P.current=k,W(k),c<1?u.current=requestAnimationFrame(v):(cancelAnimationFrame(u.current),u.current=null,F(h[r]))};u.current&&cancelAnimationFrame(u.current),u.current=requestAnimationFrame(v)},O=()=>{const n=Math.min(C,R),r=Math.max(C,R);if(x)S(Math.floor(Math.random()*(r-n+1))+n);else{const e=Array.from({length:r-n+1},(s,j)=>n+j).filter(s=>!A.includes(s));if(!e.length)return alert("Hết số để quay!");const d=e[Math.floor(Math.random()*e.length)];q(s=>[...s,d]),S(d)}};return l.useEffect(()=>()=>{u.current&&cancelAnimationFrame(u.current)},[]),t.jsxs("div",{className:"w-full h-full flex flex-col overflow-hidden",children:[t.jsxs("div",{className:"relative flex items-center gap-3 mb-3 mt-3",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>m("list"),className:`px-4 py-2 rounded-xl border transition
              ${a==="list"?"bg-cyan-500/80 border-cyan-400 text-white":"bg-white/10 hover:bg-white/15 border-white/20"}`,children:"Vòng quay danh sách"}),t.jsx("button",{onClick:()=>m("number"),className:`px-4 py-2 rounded-xl border transition
              ${a==="number"?"bg-cyan-500/80 border-cyan-400 text-white":"bg-white/10 hover:bg-white/15 border-white/20"}`,children:"Quay số trong khoảng"})]}),t.jsx("div",{className:"flex-1 flex items-center justify-center ml-10",children:a==="list"&&t.jsx("div",{className:`rounded-2xl glass px-4 py-2 text-center ml-20
                             text-3xl md:text-4xl font-extrabold
                             bg-gradient-to-r from-cyan-400 to-violet-500 bg-clip-text text-transparent
                             ${p?"":"opacity-50"}`,children:p??"Chưa có kết quả"})}),t.jsxs("label",{className:"flex items-center gap-2 text-sm opacity-90",children:[t.jsx("input",{type:"checkbox",checked:x,onChange:n=>w(n.target.checked)}),"Cho phép trùng lặp"]})]}),a==="list"?t.jsxs("div",{className:"flex flex-1 gap-6 min-h-0 overflow-hidden",children:[t.jsxs("div",{className:"w-[360px] max-w-[45%] h-full min-h-0 flex flex-col",children:[t.jsx("label",{className:"mb-2 text-sm opacity-80",children:"Mỗi dòng 1 lựa chọn"}),t.jsx("textarea",{value:f,onChange:n=>D(n.target.value),className:"flex-1 min-h-0 rounded-2xl glass p-3 resize-none overflow-auto"}),t.jsxs("div",{className:"mt-3 flex gap-2",children:[t.jsx("button",{onClick:_,className:"rounded-2xl px-4 py-2 bg-blue-500/20 hover:bg-blue-500/30 border border-blue-400 transition",children:"Quay"}),t.jsx("button",{onClick:()=>F(null),className:"rounded-2xl px-3 py-2 bg-white/10 hover:bg-white/15 border border-white/20",children:"Xoá kết quả"})]}),p&&t.jsxs("div",{className:"mt-3 rounded-xl glass px-3 py-2 text-sm",children:["✅ Kết quả: ",t.jsx("b",{children:p})]})]}),t.jsx("div",{className:"flex-1 min-w-0 h-full min-h-0 overflow-hidden flex items-center justify-center mr-5",children:t.jsx("div",{ref:E,className:"w-full h-full flex items-center justify-center",children:t.jsx("canvas",{ref:I,className:"rounded-2xl bg-black/10 backdrop-blur"})})})]}):t.jsxs("div",{className:"flex flex-1 gap-6 min-h-0 overflow-hidden",children:[t.jsxs("div",{className:"w-[360px] max-w-[45%] h-full min-h-0 flex flex-col gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"number",value:C,onChange:n=>H(parseInt(n.target.value||"0",10)),className:"w-28 rounded-xl glass p-2 text-center"}),t.jsx("span",{className:"opacity-80",children:"đến"}),t.jsx("input",{type:"number",value:R,onChange:n=>Q(parseInt(n.target.value||"0",10)),className:"w-28 rounded-xl glass p-2 text-center"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:O,className:"rounded-2xl px-4 py-2 bg-blue-500/20 hover:bg-blue-500/30 border border-blue-400 transition",children:"Quay số"}),t.jsx("button",{onClick:()=>{S(null),q([])},className:"rounded-2xl px-3 py-2 bg-white/10 hover:bg-white/15 border border-white/20",children:"Reset"})]}),A.length>0&&!x&&t.jsxs("div",{className:"text-xs opacity-70",children:["Đã ra: ",A.join(", ")]})]}),t.jsx("div",{className:"flex-1 min-w-0 h-full min-h-0 overflow-hidden flex items-center justify-center",children:t.jsx("div",{className:"flex items-center justify-center w-[80%] h-[80%] rounded-2xl glass",children:T===null?t.jsx("div",{className:"opacity-60",children:"Chưa có kết quả"}):t.jsx("div",{className:`text-center font-extrabold leading-none\r
                            text-6xl sm:text-7xl md:text-8xl lg:text-9xl\r
                            bg-gradient-to-r from-cyan-400 to-violet-500 bg-clip-text text-transparent`,children:T})})})]})]})}export{G as default};
