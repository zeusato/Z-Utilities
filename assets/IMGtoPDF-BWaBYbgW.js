import{r as C,j as w}from"./index-DaAwleHW.js";import{E as vn}from"./jspdf.es.min-DidRsJh3.js";import"./_commonjsHelpers-Cpj98o6Y.js";/**!
 * Sortable 1.15.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function kt(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,r)}return t}function xe(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?kt(Object(t),!0).forEach(function(r){bn(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):kt(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function tt(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?tt=function(e){return typeof e}:tt=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tt(n)}function bn(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function De(){return De=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},De.apply(this,arguments)}function xn(n,e){if(n==null)return{};var t={},r=Object.keys(n),o,i;for(i=0;i<r.length;i++)o=r[i],!(e.indexOf(o)>=0)&&(t[o]=n[o]);return t}function wn(n,e){if(n==null)return{};var t=xn(n,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}var yn="1.15.0";function Ee(n){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(n)}var Se=Ee(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Ke=Ee(/Edge/i),Mt=Ee(/firefox/i),He=Ee(/safari/i)&&!Ee(/chrome/i)&&!Ee(/android/i),Ht=Ee(/iP(ad|od|hone)/i),Wt=Ee(/chrome/i)&&Ee(/android/i),$t={capture:!1,passive:!1};function k(n,e,t){n.addEventListener(e,t,!Se&&$t)}function P(n,e,t){n.removeEventListener(e,t,!Se&&$t)}function at(n,e){if(e){if(e[0]===">"&&(e=e.substring(1)),n)try{if(n.matches)return n.matches(e);if(n.msMatchesSelector)return n.msMatchesSelector(e);if(n.webkitMatchesSelector)return n.webkitMatchesSelector(e)}catch{return!1}return!1}}function En(n){return n.host&&n!==document&&n.host.nodeType?n.host:n.parentNode}function ve(n,e,t,r){if(n){t=t||document;do{if(e!=null&&(e[0]===">"?n.parentNode===t&&at(n,e):at(n,e))||r&&n===t)return n;if(n===t)break}while(n=En(n))}return null}var Rt=/\s+/g;function ae(n,e,t){if(n&&e)if(n.classList)n.classList[t?"add":"remove"](e);else{var r=(" "+n.className+" ").replace(Rt," ").replace(" "+e+" "," ");n.className=(r+(t?" "+e:"")).replace(Rt," ")}}function E(n,e,t){var r=n&&n.style;if(r){if(t===void 0)return document.defaultView&&document.defaultView.getComputedStyle?t=document.defaultView.getComputedStyle(n,""):n.currentStyle&&(t=n.currentStyle),e===void 0?t:t[e];!(e in r)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),r[e]=t+(typeof t=="string"?"":"px")}}function Fe(n,e){var t="";if(typeof n=="string")t=n;else do{var r=E(n,"transform");r&&r!=="none"&&(t=r+" "+t)}while(!e&&(n=n.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(t)}function Gt(n,e,t){if(n){var r=n.getElementsByTagName(e),o=0,i=r.length;if(t)for(;o<i;o++)t(r[o],o);return r}return[]}function be(){var n=document.scrollingElement;return n||document.documentElement}function L(n,e,t,r,o){if(!(!n.getBoundingClientRect&&n!==window)){var i,a,l,s,d,b,c;if(n!==window&&n.parentNode&&n!==be()?(i=n.getBoundingClientRect(),a=i.top,l=i.left,s=i.bottom,d=i.right,b=i.height,c=i.width):(a=0,l=0,s=window.innerHeight,d=window.innerWidth,b=window.innerHeight,c=window.innerWidth),(e||t)&&n!==window&&(o=o||n.parentNode,!Se))do if(o&&o.getBoundingClientRect&&(E(o,"transform")!=="none"||t&&E(o,"position")!=="static")){var S=o.getBoundingClientRect();a-=S.top+parseInt(E(o,"border-top-width")),l-=S.left+parseInt(E(o,"border-left-width")),s=a+i.height,d=l+i.width;break}while(o=o.parentNode);if(r&&n!==window){var x=Fe(o||n),N=x&&x.a,A=x&&x.d;x&&(a/=A,l/=N,c/=N,b/=A,s=a+b,d=l+c)}return{top:a,left:l,bottom:s,right:d,width:c,height:b}}}function Ft(n,e,t){for(var r=Ie(n,!0),o=L(n)[e];r;){var i=L(r)[t],a=void 0;if(a=o>=i,!a)return r;if(r===be())break;r=Ie(r,!1)}return!1}function Xe(n,e,t,r){for(var o=0,i=0,a=n.children;i<a.length;){if(a[i].style.display!=="none"&&a[i]!==D.ghost&&(r||a[i]!==D.dragged)&&ve(a[i],t.draggable,n,!1)){if(o===e)return a[i];o++}i++}return null}function Nt(n,e){for(var t=n.lastElementChild;t&&(t===D.ghost||E(t,"display")==="none"||e&&!at(t,e));)t=t.previousElementSibling;return t||null}function fe(n,e){var t=0;if(!n||!n.parentNode)return-1;for(;n=n.previousElementSibling;)n.nodeName.toUpperCase()!=="TEMPLATE"&&n!==D.clone&&(!e||at(n,e))&&t++;return t}function Xt(n){var e=0,t=0,r=be();if(n)do{var o=Fe(n),i=o.a,a=o.d;e+=n.scrollLeft*i,t+=n.scrollTop*a}while(n!==r&&(n=n.parentNode));return[e,t]}function Dn(n,e){for(var t in n)if(n.hasOwnProperty(t)){for(var r in e)if(e.hasOwnProperty(r)&&e[r]===n[t][r])return Number(t)}return-1}function Ie(n,e){if(!n||!n.getBoundingClientRect)return be();var t=n,r=!1;do if(t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight){var o=E(t);if(t.clientWidth<t.scrollWidth&&(o.overflowX=="auto"||o.overflowX=="scroll")||t.clientHeight<t.scrollHeight&&(o.overflowY=="auto"||o.overflowY=="scroll")){if(!t.getBoundingClientRect||t===document.body)return be();if(r||e)return t;r=!0}}while(t=t.parentNode);return be()}function Sn(n,e){if(n&&e)for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function mt(n,e){return Math.round(n.top)===Math.round(e.top)&&Math.round(n.left)===Math.round(e.left)&&Math.round(n.height)===Math.round(e.height)&&Math.round(n.width)===Math.round(e.width)}var We;function Ut(n,e){return function(){if(!We){var t=arguments,r=this;t.length===1?n.call(r,t[0]):n.apply(r,t),We=setTimeout(function(){We=void 0},e)}}}function _n(){clearTimeout(We),We=void 0}function Kt(n,e,t){n.scrollLeft+=e,n.scrollTop+=t}function Vt(n){var e=window.Polymer,t=window.jQuery||window.Zepto;return e&&e.dom?e.dom(n).cloneNode(!0):t?t(n).clone(!0)[0]:n.cloneNode(!0)}var se="Sortable"+new Date().getTime();function Cn(){var n=[],e;return{captureAnimationState:function(){if(n=[],!!this.options.animation){var r=[].slice.call(this.el.children);r.forEach(function(o){if(!(E(o,"display")==="none"||o===D.ghost)){n.push({target:o,rect:L(o)});var i=xe({},n[n.length-1].rect);if(o.thisAnimationDuration){var a=Fe(o,!0);a&&(i.top-=a.f,i.left-=a.e)}o.fromRect=i}})}},addAnimationState:function(r){n.push(r)},removeAnimationState:function(r){n.splice(Dn(n,{target:r}),1)},animateAll:function(r){var o=this;if(!this.options.animation){clearTimeout(e),typeof r=="function"&&r();return}var i=!1,a=0;n.forEach(function(l){var s=0,d=l.target,b=d.fromRect,c=L(d),S=d.prevFromRect,x=d.prevToRect,N=l.rect,A=Fe(d,!0);A&&(c.top-=A.f,c.left-=A.e),d.toRect=c,d.thisAnimationDuration&&mt(S,c)&&!mt(b,c)&&(N.top-c.top)/(N.left-c.left)===(b.top-c.top)/(b.left-c.left)&&(s=In(N,S,x,o.options)),mt(c,b)||(d.prevFromRect=b,d.prevToRect=c,s||(s=o.options.animation),o.animate(d,N,c,s)),s&&(i=!0,a=Math.max(a,s),clearTimeout(d.animationResetTimer),d.animationResetTimer=setTimeout(function(){d.animationTime=0,d.prevFromRect=null,d.fromRect=null,d.prevToRect=null,d.thisAnimationDuration=null},s),d.thisAnimationDuration=s)}),clearTimeout(e),i?e=setTimeout(function(){typeof r=="function"&&r()},a):typeof r=="function"&&r(),n=[]},animate:function(r,o,i,a){if(a){E(r,"transition",""),E(r,"transform","");var l=Fe(this.el),s=l&&l.a,d=l&&l.d,b=(o.left-i.left)/(s||1),c=(o.top-i.top)/(d||1);r.animatingX=!!b,r.animatingY=!!c,E(r,"transform","translate3d("+b+"px,"+c+"px,0)"),this.forRepaintDummy=Tn(r),E(r,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),E(r,"transform","translate3d(0,0,0)"),typeof r.animated=="number"&&clearTimeout(r.animated),r.animated=setTimeout(function(){E(r,"transition",""),E(r,"transform",""),r.animated=!1,r.animatingX=!1,r.animatingY=!1},a)}}}}function Tn(n){return n.offsetWidth}function In(n,e,t,r){return Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))/Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))*r.animation}var Ae=[],vt={initializeByDefault:!0},Ve={mount:function(e){for(var t in vt)vt.hasOwnProperty(t)&&!(t in e)&&(e[t]=vt[t]);Ae.forEach(function(r){if(r.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Ae.push(e)},pluginEvent:function(e,t,r){var o=this;this.eventCanceled=!1,r.cancel=function(){o.eventCanceled=!0};var i=e+"Global";Ae.forEach(function(a){t[a.pluginName]&&(t[a.pluginName][i]&&t[a.pluginName][i](xe({sortable:t},r)),t.options[a.pluginName]&&t[a.pluginName][e]&&t[a.pluginName][e](xe({sortable:t},r)))})},initializePlugins:function(e,t,r,o){Ae.forEach(function(l){var s=l.pluginName;if(!(!e.options[s]&&!l.initializeByDefault)){var d=new l(e,t,e.options);d.sortable=e,d.options=e.options,e[s]=d,De(r,d.defaults)}});for(var i in e.options)if(e.options.hasOwnProperty(i)){var a=this.modifyOption(e,i,e.options[i]);typeof a<"u"&&(e.options[i]=a)}},getEventProperties:function(e,t){var r={};return Ae.forEach(function(o){typeof o.eventProperties=="function"&&De(r,o.eventProperties.call(t[o.pluginName],e))}),r},modifyOption:function(e,t,r){var o;return Ae.forEach(function(i){e[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[t]=="function"&&(o=i.optionListeners[t].call(e[i.pluginName],r))}),o}};function Nn(n){var e=n.sortable,t=n.rootEl,r=n.name,o=n.targetEl,i=n.cloneEl,a=n.toEl,l=n.fromEl,s=n.oldIndex,d=n.newIndex,b=n.oldDraggableIndex,c=n.newDraggableIndex,S=n.originalEvent,x=n.putSortable,N=n.extraEventProperties;if(e=e||t&&t[se],!!e){var A,q=e.options,he="on"+r.charAt(0).toUpperCase()+r.substr(1);window.CustomEvent&&!Se&&!Ke?A=new CustomEvent(r,{bubbles:!0,cancelable:!0}):(A=document.createEvent("Event"),A.initEvent(r,!0,!0)),A.to=a||t,A.from=l||t,A.item=o||t,A.clone=i,A.oldIndex=s,A.newIndex=d,A.oldDraggableIndex=b,A.newDraggableIndex=c,A.originalEvent=S,A.pullMode=x?x.lastPutMode:void 0;var H=xe(xe({},N),Ve.getEventProperties(r,e));for(var te in H)A[te]=H[te];t&&t.dispatchEvent(A),q[he]&&q[he].call(e,A)}}var On=["evt"],ee=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=r.evt,i=wn(r,On);Ve.pluginEvent.bind(D)(e,t,xe({dragEl:g,parentEl:Y,ghostEl:I,rootEl:F,nextEl:je,lastDownEl:nt,cloneEl:X,cloneHidden:Te,dragStarted:Ye,putSortable:G,activeSortable:D.active,originalEvent:o,oldIndex:Re,oldDraggableIndex:$e,newIndex:le,newDraggableIndex:Ce,hideGhostForTarget:Qt,unhideGhostForTarget:en,cloneNowHidden:function(){Te=!0},cloneNowShown:function(){Te=!1},dispatchSortableEvent:function(l){Z({sortable:t,name:l,originalEvent:o})}},i))};function Z(n){Nn(xe({putSortable:G,cloneEl:X,targetEl:g,rootEl:F,oldIndex:Re,oldDraggableIndex:$e,newIndex:le,newDraggableIndex:Ce},n))}var g,Y,I,F,je,nt,X,Te,Re,le,$e,Ce,Ze,G,Me=!1,lt=!1,st=[],Oe,me,bt,xt,zt,Yt,Ye,ke,Ge,Ue=!1,Je=!1,rt,V,wt=[],_t=!1,ct=[],dt=typeof document<"u",Qe=Ht,Bt=Ke||Se?"cssFloat":"float",Pn=dt&&!Wt&&!Ht&&"draggable"in document.createElement("div"),qt=(function(){if(dt){if(Se)return!1;var n=document.createElement("x");return n.style.cssText="pointer-events:auto",n.style.pointerEvents==="auto"}})(),Zt=function(e,t){var r=E(e),o=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),i=Xe(e,0,t),a=Xe(e,1,t),l=i&&E(i),s=a&&E(a),d=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+L(i).width,b=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+L(a).width;if(r.display==="flex")return r.flexDirection==="column"||r.flexDirection==="column-reverse"?"vertical":"horizontal";if(r.display==="grid")return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&l.float&&l.float!=="none"){var c=l.float==="left"?"left":"right";return a&&(s.clear==="both"||s.clear===c)?"vertical":"horizontal"}return i&&(l.display==="block"||l.display==="flex"||l.display==="table"||l.display==="grid"||d>=o&&r[Bt]==="none"||a&&r[Bt]==="none"&&d+b>o)?"vertical":"horizontal"},jn=function(e,t,r){var o=r?e.left:e.top,i=r?e.right:e.bottom,a=r?e.width:e.height,l=r?t.left:t.top,s=r?t.right:t.bottom,d=r?t.width:t.height;return o===l||i===s||o+a/2===l+d/2},An=function(e,t){var r;return st.some(function(o){var i=o[se].options.emptyInsertThreshold;if(!(!i||Nt(o))){var a=L(o),l=e>=a.left-i&&e<=a.right+i,s=t>=a.top-i&&t<=a.bottom+i;if(l&&s)return r=o}}),r},Jt=function(e){function t(i,a){return function(l,s,d,b){var c=l.options.group.name&&s.options.group.name&&l.options.group.name===s.options.group.name;if(i==null&&(a||c))return!0;if(i==null||i===!1)return!1;if(a&&i==="clone")return i;if(typeof i=="function")return t(i(l,s,d,b),a)(l,s,d,b);var S=(a?l:s).options.group.name;return i===!0||typeof i=="string"&&i===S||i.join&&i.indexOf(S)>-1}}var r={},o=e.group;(!o||tt(o)!="object")&&(o={name:o}),r.name=o.name,r.checkPull=t(o.pull,!0),r.checkPut=t(o.put),r.revertClone=o.revertClone,e.group=r},Qt=function(){!qt&&I&&E(I,"display","none")},en=function(){!qt&&I&&E(I,"display","")};dt&&!Wt&&document.addEventListener("click",function(n){if(lt)return n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.stopImmediatePropagation&&n.stopImmediatePropagation(),lt=!1,!1},!0);var Pe=function(e){if(g){e=e.touches?e.touches[0]:e;var t=An(e.clientX,e.clientY);if(t){var r={};for(var o in e)e.hasOwnProperty(o)&&(r[o]=e[o]);r.target=r.rootEl=t,r.preventDefault=void 0,r.stopPropagation=void 0,t[se]._onDragOver(r)}}},kn=function(e){g&&g.parentNode[se]._isOutsideThisEl(e.target)};function D(n,e){if(!(n&&n.nodeType&&n.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(n));this.el=n,this.options=e=De({},e),n[se]=this;var t={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(n.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Zt(n,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,l){a.setData("Text",l.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:D.supportPointer!==!1&&"PointerEvent"in window&&!He,emptyInsertThreshold:5};Ve.initializePlugins(this,n,t);for(var r in t)!(r in e)&&(e[r]=t[r]);Jt(e);for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this));this.nativeDraggable=e.forceFallback?!1:Pn,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?k(n,"pointerdown",this._onTapStart):(k(n,"mousedown",this._onTapStart),k(n,"touchstart",this._onTapStart)),this.nativeDraggable&&(k(n,"dragover",this),k(n,"dragenter",this)),st.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),De(this,Cn())}D.prototype={constructor:D,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(ke=null)},_getDirection:function(e,t){return typeof this.options.direction=="function"?this.options.direction.call(this,e,t,g):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,r=this.el,o=this.options,i=o.preventOnFilter,a=e.type,l=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,s=(l||e).target,d=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,b=o.filter;if(Ln(r),!g&&!(/mousedown|pointerdown/.test(a)&&e.button!==0||o.disabled)&&!d.isContentEditable&&!(!this.nativeDraggable&&He&&s&&s.tagName.toUpperCase()==="SELECT")&&(s=ve(s,o.draggable,r,!1),!(s&&s.animated)&&nt!==s)){if(Re=fe(s),$e=fe(s,o.draggable),typeof b=="function"){if(b.call(this,e,s,this)){Z({sortable:t,rootEl:d,name:"filter",targetEl:s,toEl:r,fromEl:r}),ee("filter",t,{evt:e}),i&&e.cancelable&&e.preventDefault();return}}else if(b&&(b=b.split(",").some(function(c){if(c=ve(d,c.trim(),r,!1),c)return Z({sortable:t,rootEl:c,name:"filter",targetEl:s,fromEl:r,toEl:r}),ee("filter",t,{evt:e}),!0}),b)){i&&e.cancelable&&e.preventDefault();return}o.handle&&!ve(d,o.handle,r,!1)||this._prepareDragStart(e,l,s)}}},_prepareDragStart:function(e,t,r){var o=this,i=o.el,a=o.options,l=i.ownerDocument,s;if(r&&!g&&r.parentNode===i){var d=L(r);if(F=i,g=r,Y=g.parentNode,je=g.nextSibling,nt=r,Ze=a.group,D.dragged=g,Oe={target:g,clientX:(t||e).clientX,clientY:(t||e).clientY},zt=Oe.clientX-d.left,Yt=Oe.clientY-d.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,g.style["will-change"]="all",s=function(){if(ee("delayEnded",o,{evt:e}),D.eventCanceled){o._onDrop();return}o._disableDelayedDragEvents(),!Mt&&o.nativeDraggable&&(g.draggable=!0),o._triggerDragStart(e,t),Z({sortable:o,name:"choose",originalEvent:e}),ae(g,a.chosenClass,!0)},a.ignore.split(",").forEach(function(b){Gt(g,b.trim(),yt)}),k(l,"dragover",Pe),k(l,"mousemove",Pe),k(l,"touchmove",Pe),k(l,"mouseup",o._onDrop),k(l,"touchend",o._onDrop),k(l,"touchcancel",o._onDrop),Mt&&this.nativeDraggable&&(this.options.touchStartThreshold=4,g.draggable=!0),ee("delayStart",this,{evt:e}),a.delay&&(!a.delayOnTouchOnly||t)&&(!this.nativeDraggable||!(Ke||Se))){if(D.eventCanceled){this._onDrop();return}k(l,"mouseup",o._disableDelayedDrag),k(l,"touchend",o._disableDelayedDrag),k(l,"touchcancel",o._disableDelayedDrag),k(l,"mousemove",o._delayedDragTouchMoveHandler),k(l,"touchmove",o._delayedDragTouchMoveHandler),a.supportPointer&&k(l,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(s,a.delay)}else s()}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){g&&yt(g),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;P(e,"mouseup",this._disableDelayedDrag),P(e,"touchend",this._disableDelayedDrag),P(e,"touchcancel",this._disableDelayedDrag),P(e,"mousemove",this._delayedDragTouchMoveHandler),P(e,"touchmove",this._delayedDragTouchMoveHandler),P(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||e.pointerType=="touch"&&e,!this.nativeDraggable||t?this.options.supportPointer?k(document,"pointermove",this._onTouchMove):t?k(document,"touchmove",this._onTouchMove):k(document,"mousemove",this._onTouchMove):(k(g,"dragend",this),k(F,"dragstart",this._onDragStart));try{document.selection?ot(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,t){if(Me=!1,F&&g){ee("dragStarted",this,{evt:t}),this.nativeDraggable&&k(document,"dragover",kn);var r=this.options;!e&&ae(g,r.dragClass,!1),ae(g,r.ghostClass,!0),D.active=this,e&&this._appendGhost(),Z({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(me){this._lastX=me.clientX,this._lastY=me.clientY,Qt();for(var e=document.elementFromPoint(me.clientX,me.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(me.clientX,me.clientY),e!==t);)t=e;if(g.parentNode[se]._isOutsideThisEl(e),t)do{if(t[se]){var r=void 0;if(r=t[se]._onDragOver({clientX:me.clientX,clientY:me.clientY,target:e,rootEl:t}),r&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);en()}},_onTouchMove:function(e){if(Oe){var t=this.options,r=t.fallbackTolerance,o=t.fallbackOffset,i=e.touches?e.touches[0]:e,a=I&&Fe(I,!0),l=I&&a&&a.a,s=I&&a&&a.d,d=Qe&&V&&Xt(V),b=(i.clientX-Oe.clientX+o.x)/(l||1)+(d?d[0]-wt[0]:0)/(l||1),c=(i.clientY-Oe.clientY+o.y)/(s||1)+(d?d[1]-wt[1]:0)/(s||1);if(!D.active&&!Me){if(r&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<r)return;this._onDragStart(e,!0)}if(I){a?(a.e+=b-(bt||0),a.f+=c-(xt||0)):a={a:1,b:0,c:0,d:1,e:b,f:c};var S="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");E(I,"webkitTransform",S),E(I,"mozTransform",S),E(I,"msTransform",S),E(I,"transform",S),bt=b,xt=c,me=i}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!I){var e=this.options.fallbackOnBody?document.body:F,t=L(g,!0,Qe,!0,e),r=this.options;if(Qe){for(V=e;E(V,"position")==="static"&&E(V,"transform")==="none"&&V!==document;)V=V.parentNode;V!==document.body&&V!==document.documentElement?(V===document&&(V=be()),t.top+=V.scrollTop,t.left+=V.scrollLeft):V=be(),wt=Xt(V)}I=g.cloneNode(!0),ae(I,r.ghostClass,!1),ae(I,r.fallbackClass,!0),ae(I,r.dragClass,!0),E(I,"transition",""),E(I,"transform",""),E(I,"box-sizing","border-box"),E(I,"margin",0),E(I,"top",t.top),E(I,"left",t.left),E(I,"width",t.width),E(I,"height",t.height),E(I,"opacity","0.8"),E(I,"position",Qe?"absolute":"fixed"),E(I,"zIndex","100000"),E(I,"pointerEvents","none"),D.ghost=I,e.appendChild(I),E(I,"transform-origin",zt/parseInt(I.style.width)*100+"% "+Yt/parseInt(I.style.height)*100+"%")}},_onDragStart:function(e,t){var r=this,o=e.dataTransfer,i=r.options;if(ee("dragStart",this,{evt:e}),D.eventCanceled){this._onDrop();return}ee("setupClone",this),D.eventCanceled||(X=Vt(g),X.removeAttribute("id"),X.draggable=!1,X.style["will-change"]="",this._hideClone(),ae(X,this.options.chosenClass,!1),D.clone=X),r.cloneId=ot(function(){ee("clone",r),!D.eventCanceled&&(r.options.removeCloneOnHide||F.insertBefore(X,g),r._hideClone(),Z({sortable:r,name:"clone"}))}),!t&&ae(g,i.dragClass,!0),t?(lt=!0,r._loopId=setInterval(r._emulateDragOver,50)):(P(document,"mouseup",r._onDrop),P(document,"touchend",r._onDrop),P(document,"touchcancel",r._onDrop),o&&(o.effectAllowed="move",i.setData&&i.setData.call(r,o,g)),k(document,"drop",r),E(g,"transform","translateZ(0)")),Me=!0,r._dragStartId=ot(r._dragStarted.bind(r,t,e)),k(document,"selectstart",r),Ye=!0,He&&E(document.body,"user-select","none")},_onDragOver:function(e){var t=this.el,r=e.target,o,i,a,l=this.options,s=l.group,d=D.active,b=Ze===s,c=l.sort,S=G||d,x,N=this,A=!1;if(_t)return;function q(_e,ze){ee(_e,N,xe({evt:e,isOwner:b,axis:x?"vertical":"horizontal",revert:a,dragRect:o,targetRect:i,canSort:c,fromSortable:S,target:r,completed:H,onMove:function(qe,ft){return et(F,t,g,o,qe,L(qe),e,ft)},changed:te},ze))}function he(){q("dragOverAnimationCapture"),N.captureAnimationState(),N!==S&&S.captureAnimationState()}function H(_e){return q("dragOverCompleted",{insertion:_e}),_e&&(b?d._hideClone():d._showClone(N),N!==S&&(ae(g,G?G.options.ghostClass:d.options.ghostClass,!1),ae(g,l.ghostClass,!0)),G!==N&&N!==D.active?G=N:N===D.active&&G&&(G=null),S===N&&(N._ignoreWhileAnimating=r),N.animateAll(function(){q("dragOverAnimationComplete"),N._ignoreWhileAnimating=null}),N!==S&&(S.animateAll(),S._ignoreWhileAnimating=null)),(r===g&&!g.animated||r===t&&!r.animated)&&(ke=null),!l.dragoverBubble&&!e.rootEl&&r!==document&&(g.parentNode[se]._isOutsideThisEl(e.target),!_e&&Pe(e)),!l.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),A=!0}function te(){le=fe(g),Ce=fe(g,l.draggable),Z({sortable:N,name:"change",toEl:t,newIndex:le,newDraggableIndex:Ce,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),r=ve(r,l.draggable,t,!0),q("dragOver"),D.eventCanceled)return A;if(g.contains(e.target)||r.animated&&r.animatingX&&r.animatingY||N._ignoreWhileAnimating===r)return H(!1);if(lt=!1,d&&!l.disabled&&(b?c||(a=Y!==F):G===this||(this.lastPutMode=Ze.checkPull(this,d,g,e))&&s.checkPut(this,d,g,e))){if(x=this._getDirection(e,r)==="vertical",o=L(g),q("dragOverValid"),D.eventCanceled)return A;if(a)return Y=F,he(),this._hideClone(),q("revert"),D.eventCanceled||(je?F.insertBefore(g,je):F.appendChild(g)),H(!0);var U=Nt(t,l.draggable);if(!U||Xn(e,x,this)&&!U.animated){if(U===g)return H(!1);if(U&&t===e.target&&(r=U),r&&(i=L(r)),et(F,t,g,o,r,i,e,!!r)!==!1)return he(),U&&U.nextSibling?t.insertBefore(g,U.nextSibling):t.appendChild(g),Y=t,te(),H(!0)}else if(U&&Fn(e,x,this)){var ne=Xe(t,0,l,!0);if(ne===g)return H(!1);if(r=ne,i=L(r),et(F,t,g,o,r,i,e,!1)!==!1)return he(),t.insertBefore(g,ne),Y=t,te(),H(!0)}else if(r.parentNode===t){i=L(r);var J=0,re,ge=g.parentNode!==t,W=!jn(g.animated&&g.toRect||o,r.animated&&r.toRect||i,x),oe=x?"top":"left",Q=Ft(r,"top","top")||Ft(g,"top","top"),we=Q?Q.scrollTop:void 0;ke!==r&&(re=i[oe],Ue=!1,Je=!W&&l.invertSwap||ge),J=zn(e,r,i,x,W?1:l.swapThreshold,l.invertedSwapThreshold==null?l.swapThreshold:l.invertedSwapThreshold,Je,ke===r);var ie;if(J!==0){var pe=fe(g);do pe-=J,ie=Y.children[pe];while(ie&&(E(ie,"display")==="none"||ie===I))}if(J===0||ie===r)return H(!1);ke=r,Ge=J;var Ne=r.nextElementSibling,ce=!1;ce=J===1;var ye=et(F,t,g,o,r,i,e,ce);if(ye!==!1)return(ye===1||ye===-1)&&(ce=ye===1),_t=!0,setTimeout(Rn,30),he(),ce&&!Ne?t.appendChild(g):r.parentNode.insertBefore(g,ce?Ne:r),Q&&Kt(Q,0,we-Q.scrollTop),Y=g.parentNode,re!==void 0&&!Je&&(rt=Math.abs(re-L(r)[oe])),te(),H(!0)}if(t.contains(g))return H(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){P(document,"mousemove",this._onTouchMove),P(document,"touchmove",this._onTouchMove),P(document,"pointermove",this._onTouchMove),P(document,"dragover",Pe),P(document,"mousemove",Pe),P(document,"touchmove",Pe)},_offUpEvents:function(){var e=this.el.ownerDocument;P(e,"mouseup",this._onDrop),P(e,"touchend",this._onDrop),P(e,"pointerup",this._onDrop),P(e,"touchcancel",this._onDrop),P(document,"selectstart",this)},_onDrop:function(e){var t=this.el,r=this.options;if(le=fe(g),Ce=fe(g,r.draggable),ee("drop",this,{evt:e}),Y=g&&g.parentNode,le=fe(g),Ce=fe(g,r.draggable),D.eventCanceled){this._nulling();return}Me=!1,Je=!1,Ue=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Ct(this.cloneId),Ct(this._dragStartId),this.nativeDraggable&&(P(document,"drop",this),P(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),He&&E(document.body,"user-select",""),E(g,"transform",""),e&&(Ye&&(e.cancelable&&e.preventDefault(),!r.dropBubble&&e.stopPropagation()),I&&I.parentNode&&I.parentNode.removeChild(I),(F===Y||G&&G.lastPutMode!=="clone")&&X&&X.parentNode&&X.parentNode.removeChild(X),g&&(this.nativeDraggable&&P(g,"dragend",this),yt(g),g.style["will-change"]="",Ye&&!Me&&ae(g,G?G.options.ghostClass:this.options.ghostClass,!1),ae(g,this.options.chosenClass,!1),Z({sortable:this,name:"unchoose",toEl:Y,newIndex:null,newDraggableIndex:null,originalEvent:e}),F!==Y?(le>=0&&(Z({rootEl:Y,name:"add",toEl:Y,fromEl:F,originalEvent:e}),Z({sortable:this,name:"remove",toEl:Y,originalEvent:e}),Z({rootEl:Y,name:"sort",toEl:Y,fromEl:F,originalEvent:e}),Z({sortable:this,name:"sort",toEl:Y,originalEvent:e})),G&&G.save()):le!==Re&&le>=0&&(Z({sortable:this,name:"update",toEl:Y,originalEvent:e}),Z({sortable:this,name:"sort",toEl:Y,originalEvent:e})),D.active&&((le==null||le===-1)&&(le=Re,Ce=$e),Z({sortable:this,name:"end",toEl:Y,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){ee("nulling",this),F=g=Y=I=je=X=nt=Te=Oe=me=Ye=le=Ce=Re=$e=ke=Ge=G=Ze=D.dragged=D.ghost=D.clone=D.active=null,ct.forEach(function(e){e.checked=!0}),ct.length=bt=xt=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":g&&(this._onDragOver(e),Mn(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],t,r=this.el.children,o=0,i=r.length,a=this.options;o<i;o++)t=r[o],ve(t,a.draggable,this.el,!1)&&e.push(t.getAttribute(a.dataIdAttr)||Bn(t));return e},sort:function(e,t){var r={},o=this.el;this.toArray().forEach(function(i,a){var l=o.children[a];ve(l,this.options.draggable,o,!1)&&(r[i]=l)},this),t&&this.captureAnimationState(),e.forEach(function(i){r[i]&&(o.removeChild(r[i]),o.appendChild(r[i]))}),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return ve(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var r=this.options;if(t===void 0)return r[e];var o=Ve.modifyOption(this,e,t);typeof o<"u"?r[e]=o:r[e]=t,e==="group"&&Jt(r)},destroy:function(){ee("destroy",this);var e=this.el;e[se]=null,P(e,"mousedown",this._onTapStart),P(e,"touchstart",this._onTapStart),P(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(P(e,"dragover",this),P(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),st.splice(st.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Te){if(ee("hideClone",this),D.eventCanceled)return;E(X,"display","none"),this.options.removeCloneOnHide&&X.parentNode&&X.parentNode.removeChild(X),Te=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Te){if(ee("showClone",this),D.eventCanceled)return;g.parentNode==F&&!this.options.group.revertClone?F.insertBefore(X,g):je?F.insertBefore(X,je):F.appendChild(X),this.options.group.revertClone&&this.animate(g,X),E(X,"display",""),Te=!1}}};function Mn(n){n.dataTransfer&&(n.dataTransfer.dropEffect="move"),n.cancelable&&n.preventDefault()}function et(n,e,t,r,o,i,a,l){var s,d=n[se],b=d.options.onMove,c;return window.CustomEvent&&!Se&&!Ke?s=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(s=document.createEvent("Event"),s.initEvent("move",!0,!0)),s.to=e,s.from=n,s.dragged=t,s.draggedRect=r,s.related=o||e,s.relatedRect=i||L(e),s.willInsertAfter=l,s.originalEvent=a,n.dispatchEvent(s),b&&(c=b.call(d,s,a)),c}function yt(n){n.draggable=!1}function Rn(){_t=!1}function Fn(n,e,t){var r=L(Xe(t.el,0,t.options,!0)),o=10;return e?n.clientX<r.left-o||n.clientY<r.top&&n.clientX<r.right:n.clientY<r.top-o||n.clientY<r.bottom&&n.clientX<r.left}function Xn(n,e,t){var r=L(Nt(t.el,t.options.draggable)),o=10;return e?n.clientX>r.right+o||n.clientX<=r.right&&n.clientY>r.bottom&&n.clientX>=r.left:n.clientX>r.right&&n.clientY>r.top||n.clientX<=r.right&&n.clientY>r.bottom+o}function zn(n,e,t,r,o,i,a,l){var s=r?n.clientY:n.clientX,d=r?t.height:t.width,b=r?t.top:t.left,c=r?t.bottom:t.right,S=!1;if(!a){if(l&&rt<d*o){if(!Ue&&(Ge===1?s>b+d*i/2:s<c-d*i/2)&&(Ue=!0),Ue)S=!0;else if(Ge===1?s<b+rt:s>c-rt)return-Ge}else if(s>b+d*(1-o)/2&&s<c-d*(1-o)/2)return Yn(e)}return S=S||a,S&&(s<b+d*i/2||s>c-d*i/2)?s>b+d/2?1:-1:0}function Yn(n){return fe(g)<fe(n)?1:-1}function Bn(n){for(var e=n.tagName+n.className+n.src+n.href+n.textContent,t=e.length,r=0;t--;)r+=e.charCodeAt(t);return r.toString(36)}function Ln(n){ct.length=0;for(var e=n.getElementsByTagName("input"),t=e.length;t--;){var r=e[t];r.checked&&ct.push(r)}}function ot(n){return setTimeout(n,0)}function Ct(n){return clearTimeout(n)}dt&&k(document,"touchmove",function(n){(D.active||Me)&&n.cancelable&&n.preventDefault()});D.utils={on:k,off:P,css:E,find:Gt,is:function(e,t){return!!ve(e,t,e,!1)},extend:Sn,throttle:Ut,closest:ve,toggleClass:ae,clone:Vt,index:fe,nextTick:ot,cancelNextTick:Ct,detectDirection:Zt,getChild:Xe};D.get=function(n){return n[se]};D.mount=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];e[0].constructor===Array&&(e=e[0]),e.forEach(function(r){if(!r.prototype||!r.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(r));r.utils&&(D.utils=xe(xe({},D.utils),r.utils)),Ve.mount(r)})};D.create=function(n,e){return new D(n,e)};D.version=yn;var B=[],Be,Tt,It=!1,Et,Dt,ut,Le;function Hn(){function n(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return n.prototype={dragStarted:function(t){var r=t.originalEvent;this.sortable.nativeDraggable?k(document,"dragover",this._handleAutoScroll):this.options.supportPointer?k(document,"pointermove",this._handleFallbackAutoScroll):r.touches?k(document,"touchmove",this._handleFallbackAutoScroll):k(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var r=t.originalEvent;!this.options.dragOverBubble&&!r.rootEl&&this._handleAutoScroll(r)},drop:function(){this.sortable.nativeDraggable?P(document,"dragover",this._handleAutoScroll):(P(document,"pointermove",this._handleFallbackAutoScroll),P(document,"touchmove",this._handleFallbackAutoScroll),P(document,"mousemove",this._handleFallbackAutoScroll)),Lt(),it(),_n()},nulling:function(){ut=Tt=Be=It=Le=Et=Dt=null,B.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,r){var o=this,i=(t.touches?t.touches[0]:t).clientX,a=(t.touches?t.touches[0]:t).clientY,l=document.elementFromPoint(i,a);if(ut=t,r||this.options.forceAutoScrollFallback||Ke||Se||He){St(t,this.options,l,r);var s=Ie(l,!0);It&&(!Le||i!==Et||a!==Dt)&&(Le&&Lt(),Le=setInterval(function(){var d=Ie(document.elementFromPoint(i,a),!0);d!==s&&(s=d,it()),St(t,o.options,d,r)},10),Et=i,Dt=a)}else{if(!this.options.bubbleScroll||Ie(l,!0)===be()){it();return}St(t,this.options,Ie(l,!1),!1)}}},De(n,{pluginName:"scroll",initializeByDefault:!0})}function it(){B.forEach(function(n){clearInterval(n.pid)}),B=[]}function Lt(){clearInterval(Le)}var St=Ut(function(n,e,t,r){if(e.scroll){var o=(n.touches?n.touches[0]:n).clientX,i=(n.touches?n.touches[0]:n).clientY,a=e.scrollSensitivity,l=e.scrollSpeed,s=be(),d=!1,b;Tt!==t&&(Tt=t,it(),Be=e.scroll,b=e.scrollFn,Be===!0&&(Be=Ie(t,!0)));var c=0,S=Be;do{var x=S,N=L(x),A=N.top,q=N.bottom,he=N.left,H=N.right,te=N.width,U=N.height,ne=void 0,J=void 0,re=x.scrollWidth,ge=x.scrollHeight,W=E(x),oe=x.scrollLeft,Q=x.scrollTop;x===s?(ne=te<re&&(W.overflowX==="auto"||W.overflowX==="scroll"||W.overflowX==="visible"),J=U<ge&&(W.overflowY==="auto"||W.overflowY==="scroll"||W.overflowY==="visible")):(ne=te<re&&(W.overflowX==="auto"||W.overflowX==="scroll"),J=U<ge&&(W.overflowY==="auto"||W.overflowY==="scroll"));var we=ne&&(Math.abs(H-o)<=a&&oe+te<re)-(Math.abs(he-o)<=a&&!!oe),ie=J&&(Math.abs(q-i)<=a&&Q+U<ge)-(Math.abs(A-i)<=a&&!!Q);if(!B[c])for(var pe=0;pe<=c;pe++)B[pe]||(B[pe]={});(B[c].vx!=we||B[c].vy!=ie||B[c].el!==x)&&(B[c].el=x,B[c].vx=we,B[c].vy=ie,clearInterval(B[c].pid),(we!=0||ie!=0)&&(d=!0,B[c].pid=setInterval((function(){r&&this.layer===0&&D.active._onTouchMove(ut);var Ne=B[this.layer].vy?B[this.layer].vy*l:0,ce=B[this.layer].vx?B[this.layer].vx*l:0;typeof b=="function"&&b.call(D.dragged.parentNode[se],ce,Ne,n,ut,B[this.layer].el)!=="continue"||Kt(B[this.layer].el,ce,Ne)}).bind({layer:c}),24))),c++}while(e.bubbleScroll&&S!==s&&(S=Ie(S,!1)));It=d}},30),tn=function(e){var t=e.originalEvent,r=e.putSortable,o=e.dragEl,i=e.activeSortable,a=e.dispatchSortableEvent,l=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(t){var d=r||i;l();var b=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,c=document.elementFromPoint(b.clientX,b.clientY);s(),d&&!d.el.contains(c)&&(a("spill"),this.onSpill({dragEl:o,putSortable:r}))}};function Ot(){}Ot.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,r=e.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var o=Xe(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(t,o):this.sortable.el.appendChild(t),this.sortable.animateAll(),r&&r.animateAll()},drop:tn};De(Ot,{pluginName:"revertOnSpill"});function Pt(){}Pt.prototype={onSpill:function(e){var t=e.dragEl,r=e.putSortable,o=r||this.sortable;o.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),o.animateAll()},drop:tn};De(Pt,{pluginName:"removeOnSpill"});D.mount(new Hn);D.mount(Pt,Ot);function Un(){const n=C.useRef(null),e=C.useRef(null),t=C.useRef(null),r=C.useRef(null),o=C.useRef(null),i=C.useRef(null),a=C.useRef({x:0,y:0}),l=C.useRef({dx:0,dy:0}),s=C.useRef(null),d=C.useRef(!1),b=C.useRef(!1),[c,S]=C.useState([]),[x,N]=C.useState(0),[A,q]=C.useState(!1),[he,H]=C.useState(0),[te,U]=C.useState(""),[ne,J]=C.useState(!1),[re,ge]=C.useState(1),[W,oe]=C.useState({x:0,y:0}),[Q,we]=C.useState(1),[ie,pe]=C.useState({x:0,y:0}),[Ne,ce]=C.useState(!1),[ye,_e]=C.useState({width:0,height:0}),ze=C.useRef({x:0,y:0}),$=C.useCallback((f,u="info")=>{const p=document.getElementById("status-container");if(!p)return;p.innerHTML="";const h=document.createElement("div");h.className="p-3 rounded-lg mb-2 font-medium fixed top-4 right-4 z-50 max-w-sm "+(u==="success"?"bg-green-100 text-green-800 border border-green-300":u==="error"?"bg-red-100 text-red-800 border border-red-300":u==="warning"?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-blue-100 text-blue-800 border border-blue-300"),h.textContent=f,p.appendChild(h),u==="success"&&setTimeout(()=>p.contains(h)&&p.removeChild(h),4e3)},[]),qe=C.useCallback(f=>{f.preventDefault(),e.current?.classList.add("ring","ring-cyan-400")},[]),ft=C.useCallback(()=>{e.current?.classList.remove("ring","ring-cyan-400")},[]),nn=C.useCallback(f=>{f.preventDefault(),e.current?.classList.remove("ring","ring-cyan-400");const u=Array.from(f.dataTransfer.files);jt(u)},[]),rn=C.useCallback(f=>{const u=Array.from(f.target.files||[]);jt(u),n.current&&(n.current.value="")},[]),jt=C.useCallback(async f=>{const u=f.filter(h=>["image/jpeg","image/jpg","image/png"].includes(h.type));if(!u.length){$("Vui lòng chọn file JPG/PNG hợp lệ","error");return}u.length>50&&u.splice(50),q(!0),H(0),U("Đang tải file…");const p=u.map((h,v)=>new Promise((m,O)=>{const T=new FileReader;T.onload=_=>{H((v+1)/u.length*100),U(`Đang xử lý: ${h.name} (${v+1}/${u.length})`);const j=String(_.target?.result||"");m({id:`img_${c.length+v}_${Date.now()}`,url:j,originalImage:j})},T.onerror=()=>O(new Error(`Failed to read ${h.name}`)),T.readAsDataURL(h)}));try{const h=await Promise.all(p);S(v=>{const m=[...v,...h];return!v.length&&m.length&&N(0),m}),q(!1),$(`Đã thêm ${h.length} ảnh. Tổng ${c.length+h.length} ảnh.`,"success")}catch(h){console.error(h),$(`Lỗi xử lý file: ${h?.message||"Không xác định"}`,"error"),q(!1)}},[c.length,$]),At=C.useCallback((f,u)=>{S(p=>{const h=f+u;if(h<0||h>=p.length)return p;const v=[...p],m=v[f];return v[f]=v[h],v[h]=m,N(O=>O===f?h:O===h?f:O),v})},[]),on=C.useCallback(f=>{S(u=>{const p=[...u],h={...p[f]},v=new Image;return v.onload=()=>{const m=document.createElement("canvas"),O=m.getContext("2d");m.width=v.height,m.height=v.width,O.translate(m.width/2,m.height/2),O.rotate(Math.PI/2),O.drawImage(v,-v.width/2,-v.height/2),h.url=m.toDataURL("image/jpeg",.92),p[f]=h,S(p)},v.src=h.url,u})},[]),an=C.useCallback(f=>{if(o.current){try{o.current.destroy()}catch{}o.current=null}f&&(o.current=new D(f,{animation:150,ghostClass:"opacity-40 bg-gray-200",onEnd:u=>{const p=u.oldIndex??-1,h=u.newIndex??-1;p<0||h<0||p===h||S(v=>{const m=[...v],[O]=m.splice(p,1);return m.splice(h,0,O),N(T=>T===p?h:T>p&&T<=h?T-1:T<p&&T>=h?T+1:T),m})}}))},[]),ln=C.useCallback(f=>{confirm("Xóa ảnh này?")&&S(u=>{const p=u.filter(h=>h.id!==f);return N(h=>Math.min(h,Math.max(0,p.length-1))),p})},[]),sn=f=>{const u=(p,h,v)=>{const m=document.createElement("div");m.dataset.handle=p,m.className="absolute w-3 h-3 bg-cyan-500 border-2 border-white rounded-full z-30",Object.assign(m.style,h,{cursor:v}),f.appendChild(m)};u("nw",{left:"0%",top:"0%",transform:"translate(-50%, -50%)"},"nwse-resize"),u("ne",{left:"100%",top:"0%",transform:"translate(-50%, -50%)"},"nesw-resize"),u("sw",{left:"0%",top:"100%",transform:"translate(-50%, -50%)"},"nesw-resize"),u("se",{left:"100%",top:"100%",transform:"translate(-50%, -50%)"},"nwse-resize"),u("n",{left:"50%",top:"0%",transform:"translate(-50%, -50%)"},"ns-resize"),u("s",{left:"50%",top:"100%",transform:"translate(-50%, -50%)"},"ns-resize"),u("w",{left:"0%",top:"50%",transform:"translate(-50%, -50%)"},"ew-resize"),u("e",{left:"100%",top:"50%",transform:"translate(-50%, -50%)"},"ew-resize")},cn=C.useCallback(()=>{const f=t.current,u=r.current;if(!f||!u||x<0)return;J(!0),document.body.style.userSelect="none";const p=document.createElement("div");p.id="crop-overlay",p.className="absolute inset-0 z-10",p.style.pointerEvents="none";const h=document.createElement("div");h.id="crop-frame",h.className="absolute border-2 border-cyan-500 bg-cyan-500/10 cursor-move z-20 rounded",h.style.pointerEvents="auto",f.appendChild(p),p.appendChild(h),i.current=h,sn(h);const v=u.getBoundingClientRect(),m=f.getBoundingClientRect(),O=Math.max(50,v.width*.5),T=Math.max(50,v.height*.5),_=v.left-m.left+(v.width-O)/2,j=v.top-m.top+(v.height-T)/2;h.style.left=`${_}px`,h.style.top=`${j}px`,h.style.width=`${O}px`,h.style.height=`${T}px`,h.addEventListener("mousedown",R=>{if(R.target.closest("[data-handle]"))return;const M=h.getBoundingClientRect();d.current=!0,s.current=null,l.current={dx:R.clientX-M.left,dy:R.clientY-M.top},R.preventDefault()}),h.querySelectorAll("[data-handle]").forEach(R=>R.addEventListener("mousedown",y=>{d.current=!1,b.current=!0,s.current=y.target.dataset.handle,a.current.x=y.clientX,a.current.y=y.clientY,y.preventDefault(),y.stopPropagation()}))},[x]),ht=C.useCallback(f=>{if(!ne)return;const u=i.current,p=r.current,h=t.current;if(!u||!p||!h)return;const v=p.getBoundingClientRect(),m=h.getBoundingClientRect(),O=v.left-m.left,T=v.top-m.top,_=O+v.width,j=T+v.height,R=u.getBoundingClientRect();if(d.current){let y=f.clientX-m.left-l.current.dx,M=f.clientY-m.top-l.current.dy;const z=R.width,ue=R.height;y=Math.max(O,Math.min(y,_-z)),M=Math.max(T,Math.min(M,j-ue)),u.style.left=`${y}px`,u.style.top=`${M}px`}if(b.current&&s.current){const y=f.clientX-a.current.x,M=f.clientY-a.current.y;let z=R.left-m.left,ue=R.top-m.top,K=R.width,de=R.height;switch(s.current){case"nw":z+=y,ue+=M,K-=y,de-=M;break;case"ne":ue+=M,K+=y,de-=M;break;case"sw":z+=y,K-=y,de+=M;break;case"se":K+=y,de+=M;break;case"n":ue+=M,de-=M;break;case"s":de+=M;break;case"w":z+=y,K-=y;break;case"e":K+=y;break}K=Math.max(50,K),de=Math.max(50,de),z=Math.max(O,Math.min(z,_-K)),ue=Math.max(T,Math.min(ue,j-de)),z+K>_&&(K=_-z),ue+de>j&&(de=j-ue),u.style.left=`${z}px`,u.style.top=`${ue}px`,u.style.width=`${K}px`,u.style.height=`${de}px`,a.current.x=f.clientX,a.current.y=f.clientY}},[ne]),gt=C.useCallback(()=>{d.current=!1,b.current=!1,s.current=null,document.body.style.userSelect=""},[]);C.useEffect(()=>{if(ne)return document.addEventListener("mousemove",ht),document.addEventListener("mouseup",gt),()=>{document.removeEventListener("mousemove",ht),document.removeEventListener("mouseup",gt)}},[ne,ht,gt]);const pt=C.useCallback(()=>{J(!1);const f=document.getElementById("crop-overlay");f?.parentElement?.removeChild(f),i.current=null,d.current=!1,b.current=!1,s.current=null,document.body.style.userSelect=""},[]),un=C.useCallback(()=>{const f=i.current,u=r.current;if(!f||!u)return;const p=f.getBoundingClientRect(),h=u.getBoundingClientRect(),v=u.naturalWidth/h.width,m=u.naturalHeight/h.height,O=(p.left-h.left)*v,T=(p.top-h.top)*m,_=p.width*v,j=p.height*m;S(R=>{const y=[...R],M={...y[x]},z=document.createElement("canvas"),ue=z.getContext("2d");z.width=Math.max(1,Math.round(_)),z.height=Math.max(1,Math.round(j));const K=new Image;return K.onload=()=>{ue.drawImage(K,O,T,_,j,0,0,z.width,z.height),M.url=z.toDataURL("image/jpeg",.9),y[x]=M,S(y),$("Đã cắt ảnh","success")},K.src=M.url,R}),pt()},[x,pt,$]),dn=C.useCallback(()=>{const f=c[x];if(!f)return;const u=new Image;u.onload=()=>{const p=document.createElement("canvas");p.width=u.width,p.height=u.height;const h=p.getContext("2d");if(!h)return;h.drawImage(u,0,0);const v=h.getImageData(0,0,p.width,p.height),m=v.data;for(let T=0;T<m.length;T+=4){const _=.2126*m[T]+.7152*m[T+1]+.0722*m[T+2];m[T]=m[T+1]=m[T+2]=_}h.putImageData(v,0,0);const O=p.toDataURL("image/jpeg",.92);S(T=>{const _=[...T];return _[x]={..._[x],url:O},_}),$("Đã chuyển ảnh sang Grayscale","success")},u.src=f.url},[c,x,$]),fn=f=>{const u=new Array(256).fill(0);for(let y=0;y<f.length;y+=4)u[f[y]]++;const p=f.length/4;let h=0;for(let y=0;y<256;y++)h+=y*u[y];let v=0,m=0,O=0,T=0,_=0,j=0,R=0;for(let y=0;y<256;y++){if(m+=u[y],m===0)continue;if(O=p-m,O===0)break;v+=y*u[y],T=v/m,_=(h-v)/O;const M=m*O*(T-_)*(T-_);M>j&&(j=M,R=y)}return R},hn=C.useCallback(()=>{const f=c[x];if(!f)return;const u=new Image;u.onload=()=>{const p=document.createElement("canvas");p.width=u.width,p.height=u.height;const h=p.getContext("2d");if(!h)return;h.drawImage(u,0,0);const v=h.getImageData(0,0,p.width,p.height),m=v.data;for(let _=0;_<m.length;_+=4){const j=.2126*m[_]+.7152*m[_+1]+.0722*m[_+2];m[_]=m[_+1]=m[_+2]=j}const O=fn(m);for(let _=0;_<m.length;_+=4){const j=m[_]>O?255:0;m[_]=m[_+1]=m[_+2]=j}h.putImageData(v,0,0);const T=p.toDataURL("image/jpeg",.92);S(_=>{const j=[..._];return j[x]={...j[x],url:T},j}),$(`Đã chuyển ảnh sang Đen trắng (ngưỡng ${O})`,"success")},u.src=f.url},[c,x,$]),gn=C.useCallback(()=>{c[x]&&(S(u=>{const p=[...u];return p[x]={...p[x],url:p[x].originalImage},p}),$("Đã khôi phục ảnh gốc","success"))},[c,x,$]);C.useEffect(()=>{const f=c[x];if(!f||!t.current){we(1),ge(1),pe({x:0,y:0}),oe({x:0,y:0}),_e({width:0,height:0});return}const u=t.current,p=u.clientWidth,h=u.clientHeight,v=new Image;v.onload=()=>{const m=v.naturalWidth,O=v.naturalHeight;_e({width:m,height:O});const T=p/m,_=h/O,j=Math.min(T,_,1),R=m*j,y=O*j,M=(p-R)/2,z=(h-y)/2;we(j),ge(j),pe({x:M,y:z}),oe({x:M,y:z})},v.src=f.url},[c,x]),C.useEffect(()=>{if(!ye.width||re<=Q){oe(ie);return}const f=t.current?.clientWidth||0,u=t.current?.clientHeight||0,p=ye.width*re,h=ye.height*re,v=0,m=f-p,O=0,T=u-h;oe(_=>({x:Math.min(v,Math.max(m,_.x)),y:Math.min(O,Math.max(T,_.y))}))},[re,ye,ie,Q]);const pn=()=>{ge(Q),oe(ie)};C.useEffect(()=>{const f=t.current;if(!f)return;const u=p=>{if(p.preventDefault(),!c[x])return;const h=-p.deltaY;ge(v=>{const m=Math.max(Q,Math.min(4,v+(h>0?.1:-.1)));return Number(m.toFixed(2))})};return f.addEventListener("wheel",u,{passive:!1}),()=>f.removeEventListener("wheel",u)},[c,x,Q]);const mn=C.useCallback(async()=>{if(!c.length){$("Không có ảnh để tạo PDF","error");return}try{const f=new vn({unit:"mm",format:"a4",orientation:"portrait"});c.forEach((p,h)=>{h>0&&f.addPage("a4","portrait");const v=new Image;v.src=p.url;const m=210,O=297,T=m-20,_=O-20,j=v.width&&v.height?v.width/v.height:1;let R,y;j>T/_?(R=T,y=R/j):(y=_,R=y*j);const M=(m-R)/2,z=(O-y)/2;f.addImage(p.url,"JPEG",M,z,R,y)});const u=new Date().toISOString().slice(0,10).replace(/-/g,"");f.save(`images_to_pdf_${u}.pdf`),$("Đã xuất PDF","success")}catch(f){console.error(f),$(`Lỗi tạo PDF: ${f?.message||"Không xác định"}`,"error")}},[c,$]);return w.jsxs("div",{className:"w-full h-full overflow-hidden",children:[w.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_0.5fr_2fr] gap-4 h-[calc(100%-1.5rem)]",children:[w.jsxs("div",{className:"min-w-0 overflow-auto lg:overflow-hidden",children:[w.jsxs("div",{ref:e,className:"mb-3 mt-1 border-2 border-dashed border-cyan-500 rounded-xl p-8 text-center bg-slate-400/30- backdrop-blur-sm transition-all duration-300 hover:border-cyan-600 hover:bg-green-50/50",onDragOver:qe,onDragLeave:ft,onDrop:nn,onClick:()=>n.current?.click(),children:[w.jsx("div",{className:"text-4xl mb-4 text-cyan-500",children:"🖼️"}),w.jsx("div",{className:"text-lg text-white mb-2",children:"Kéo thả ảnh vào đây hoặc bấm để chọn"}),w.jsx("div",{className:"text-sm text-white mb-4",children:"Hỗ trợ: JPG, PNG (tối đa 50 file)"}),w.jsx("button",{className:"bg-cyan-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-cyan-600 transition-colors",children:"Chọn ảnh để chuyển đổi"}),w.jsx("input",{ref:n,type:"file",accept:".jpg,.jpeg,.png",multiple:!0,className:"hidden",onChange:rn})]}),A&&w.jsxs("div",{className:"ml-2 mr-2 p-4 border border-zinc-300 rounded-xl bg-zinc-50",children:[w.jsx("h3",{className:"text-lg font-medium mb-2",children:"Đang xử lý file..."}),w.jsx("div",{className:"bg-zinc-200 rounded-full h-2 mb-2",children:w.jsx("div",{className:"bg-gradient-to-r from-cyan-500 to-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${he}%`}})}),w.jsx("p",{className:"text-sm text-zinc-600",children:te})]}),w.jsxs("div",{className:"ml-0 mr-2 flex flex-wrap items-center justify-center gap-2 mt-4 grid-rows-2",children:[w.jsxs("div",{className:"flex item-center justify-begin gap-5 w-full",children:[w.jsxs("button",{onClick:dn,className:"rounded-xl w-[100px] h-[50px]  bg-zinc-800 px-4 py-2 text-sm font-semibold text-white hover:bg-black disabled:opacity-50",disabled:!c.length,children:["🎛️ ",w.jsx("br",{}),"Grayscale"]}),w.jsxs("button",{onClick:hn,className:"rounded-xl w-[100px] h-[50px] bg-zinc-700 px-4 py-2 text-sm font-semibold text-white hover:bg-zinc-900 disabled:opacity-50",disabled:!c.length,children:["🖨️ ",w.jsx("br",{}),"B/W"]}),w.jsx("button",{onClick:gn,className:"rounded-xl w-[100px]  h-[50px] bg-amber-600 px-4 py-2 text-sm font-semibold text-white hover:bg-amber-700 disabled:opacity-50",disabled:!c.length,children:"↩️ Original"})]}),w.jsx("div",{className:"flex item-center justify-begin gap-5 w-full"}),w.jsxs("div",{className:"flex item-center justify-begin gap-5 w-full",children:[w.jsx("button",{onClick:()=>{S([]),N(0),J(!1);const f=document.getElementById("crop-overlay");f?.parentElement?.removeChild(f),ge(1),oe({x:0,y:0}),we(1),pe({x:0,y:0})},className:"rounded-xl w-[200px] bg-rose-600 px-4 py-2 text-sm font-semibold text-white hover:bg-rose-700 disabled:opacity-50",disabled:!c.length,children:"🔄 Reset"}),w.jsx("button",{onClick:mn,className:"rounded-xl w-[200px] bg-gradient-to-r from-green-500 to-emerald-500 px-4 py-2 text-sm font-semibold text-white shadow-lg hover:shadow-xl disabled:opacity-50",disabled:!c.length,children:"📥 Tạo PDF"})]})]})]}),w.jsx("div",{className:"min-w-0 mt-1 overflow-hidden border border-zinc-300 backdrop-blur-sm flex flex-col rounded-xl",children:w.jsxs("div",{className:"ml-2 mr-2 rounded-xl overflow-auto scrollbar-none",children:[w.jsxs("div",{className:"px-4 py-2 text-sm font-medium text-center",children:["Danh sách (",c.length,")"]}),w.jsx("div",{ref:an,className:"flex flex-col gap-2 p-2 min-h-[120px]",children:c.length===0?w.jsx("div",{className:"flex-1 flex items-center justify-center text-center text-xs text-white py-4",children:"Không có ảnh nào. Upload để bắt đầu."}):c.map((f,u)=>w.jsxs("div",{className:`relative bg-white rounded-lg p-2 cursor-pointer transition-all duration-300 border-2 border-transparent flex-shrink-0 w-full hover:shadow-md ${u===x?"border-cyan-500 ring-2 ring-cyan-500/20 shadow-md":""}`,onClick:()=>N(u),children:[w.jsxs("div",{className:"absolute top-1 right-1 flex gap-1",children:[w.jsx("button",{className:"w-5 h-5 bg-zinc-500 text-white rounded-full text-[10px] leading-[18px] hover:bg-zinc-600 disabled:opacity-40",title:"Lên",disabled:u===0,onClick:p=>{p.stopPropagation(),At(u,-1)},children:"↑"}),w.jsx("button",{className:"w-5 h-5 bg-zinc-500 text-white rounded-full text-[10px] leading-[18px] hover:bg-zinc-600 disabled:opacity-40",title:"Xuống",disabled:u===c.length-1,onClick:p=>{p.stopPropagation(),At(u,1)},children:"↓"}),w.jsx("button",{className:"w-5 h-5 bg-gray-500 text-white rounded-full text-[10px] leading-[18px] hover:bg-gray-600",title:"Xoay 90°",onClick:p=>{p.stopPropagation(),on(u)},children:"↻"}),w.jsx("button",{className:"w-5 h-5 bg-red-500 text-white rounded-full text-[12px] leading-[18px] hover:bg-red-600",title:"Xóa",onClick:p=>{p.stopPropagation(),ln(f.id)},children:"×"})]}),w.jsx("img",{src:f.url,alt:`Ảnh ${u+1}`,className:"w-full h-[120px] object-cover rounded mb-1"}),w.jsxs("div",{className:"text-center text-xs text-zinc-600",children:["Ảnh ",u+1]})]},f.id))})]})}),w.jsx("div",{className:"min-w-0 overflow-hidden",children:w.jsx("div",{className:"flex h-full flex-col",children:w.jsx("div",{ref:t,onDoubleClick:pn,onMouseDown:f=>{!c[x]||f.button!==0||f.target.closest("#crop-frame")||(ce(!0),ze.current={x:f.clientX-W.x,y:f.clientY-W.y},f.preventDefault())},onMouseMove:f=>{!Ne||!c[x]||oe({x:f.clientX-ze.current.x,y:f.clientY-ze.current.y})},onMouseUp:()=>ce(!1),onMouseLeave:()=>ce(!1),className:"relative mr-1 mt-1 w-full h-full border border-zinc-300 rounded-xl backdrop-blur-sm overflow-hidden cursor-grab active:cursor-grabbing",children:c.length?w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"absolute top-2 right-2 z-30 flex gap-2",children:ne?w.jsxs(w.Fragment,{children:[w.jsx("button",{onClick:un,className:"rounded bg-emerald-600 text-white text-xs px-3 py-1 hover:bg-emerald-700",children:"Áp dụng"}),w.jsx("button",{onClick:pt,className:"rounded bg-rose-600 text-white text-xs px-3 py-1 hover:bg-rose-700",children:"Hủy"})]}):w.jsx("button",{onClick:cn,className:"rounded bg-cyan-600 text-white text-xs px-3 py-1 hover:bg-cyan-700",children:"Cắt"})}),w.jsx("img",{ref:r,src:c[x].url,alt:`Xem trước ảnh ${x+1}`,className:"absolute top-0 left-0 max-w-none max-h-none select-none",style:{transform:`translate(${W.x}px, ${W.y}px) scale(${re})`,transformOrigin:"0 0"},draggable:!1},c[x].id)]}):w.jsx("div",{className:"flex items-center justify-center h-full text-center text-white",children:w.jsxs("div",{children:[w.jsx("div",{className:"text-4xl mb-2",children:"🖼️"}),w.jsx("p",{children:"Chọn ảnh để xem trước"})]})})})})})]}),w.jsx("div",{id:"status-container",className:"ml-2 mr-2"})]})}export{Un as default};
